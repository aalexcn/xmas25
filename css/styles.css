/* ===== BASE ===== */
:root{
    --bg1:#0b1d3a;
    --bg2:#1f4068;
    --glass: rgba(0,0,0,0.45);
    --white: #ffffff;
  }
  
  body{
    margin:0;
    height:100vh;
    background:
      radial-gradient(circle at top, rgba(255,215,0,0.12), transparent 40%),
      radial-gradient(circle at bottom left, rgba(200,0,0,0.15), transparent 45%),
      radial-gradient(circle at bottom right, rgba(0,150,80,0.15), transparent 45%),
      linear-gradient(135deg, var(--bg1), var(--bg2));
    display:flex;
    justify-content:center;
    align-items:center;
    font-family: Georgia, serif;
    overflow:hidden;
  }
  
  /* ===== NIEVE ===== */
  .snow{
    position:fixed;
    top:-10px;
    pointer-events:none;
    user-select:none;
    animation: fall linear infinite;
    z-index:1;
    filter: drop-shadow(0 0 8px rgba(255,255,255,0.25));
  }
  @keyframes fall { to { transform: translateY(110vh); } }
  
  /* ===== OVERLAY FORM ===== */
  .overlay{
    position:fixed;
    inset:0;
    background: rgba(0,0,0,0.85);
    backdrop-filter: blur(6px);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:200;
    padding:16px;
  }
  
  .overlay-card{
    width:100%;
    max-width:420px;
    text-align:center;
    color:#fff;
    padding:36px 26px;
    border-radius:22px;
    background:
      radial-gradient(circle at top, rgba(255,215,0,0.16), transparent 40%),
      radial-gradient(circle at bottom left, rgba(200,0,0,0.14), transparent 45%),
      radial-gradient(circle at bottom right, rgba(0,150,80,0.14), transparent 45%),
      rgba(15,25,45,0.95);
    box-shadow: 0 20px 60px rgba(0,0,0,0.8);
    border: 1px solid rgba(255,255,255,0.18);
  }
  
  .badge-xmas{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:44px;
    height:44px;
    border-radius:14px;
    background: rgba(255,255,255,0.08);
    box-shadow: 0 0 30px rgba(255,215,0,0.15);
    font-size: 1.3rem;
  }
  
  .tiny-note{
    font-size: 0.82rem;
    opacity: 0.85;
  }
  
  /* ===== CARTA (WRAPPER) ===== */
  .letter-wrapper{
    position:relative;
    width:100%;
    max-width:420px;
    height:85vh;
    z-index:5;
    perspective: 1200px;
    padding: 10px;
  }
  
  /* ===== SOBRE ===== */
  .envelope{
    width:100%;
    height:260px;
    border-radius:16px;
    background: linear-gradient(135deg, #f7f5ee, #e6e2d8);
    box-shadow: 0 20px 45px rgba(0,0,0,0.45);
    border: 1px solid rgba(0,0,0,0.08);
    display:flex;
    align-items:center;
    justify-content:center;
    transition: transform 0.85s ease, opacity 0.65s ease;
    position:relative;
    overflow:hidden;
  }
  
  .envelope::before{
    content:"";
    position:absolute;
    inset:-40px;
    background:
      radial-gradient(circle at 20% 20%, rgba(220,30,30,0.14), transparent 35%),
      radial-gradient(circle at 80% 30%, rgba(0,140,80,0.14), transparent 35%),
      radial-gradient(circle at 50% 90%, rgba(255,215,0,0.12), transparent 45%);
    transform: rotate(8deg);
  }
  
  .envelope-inner{
    position:relative;
    z-index:2;
    text-align:center;
    padding: 18px;
    width:100%;
    max-width: 360px;
    color:#1b1b1b;
  }
  
  .stamp{
    position:absolute;
    top: 14px;
    right: 16px;
    width: 52px;
    height: 52px;
    border-radius: 14px;
    display:flex;
    align-items:center;
    justify-content:center;
    background: rgba(255,255,255,0.55);
    box-shadow: 0 10px 18px rgba(0,0,0,0.18);
    border: 1px dashed rgba(0,0,0,0.2);
    font-size: 1.4rem;
  }
  
  .envelope h2{ font-size: 1.35rem; margin:0; }
  .envelope p{ margin:0; opacity:0.9; }
  .envelope-footer{ font-size:0.85rem; opacity:0.75; }
  
  .envelope.open{
    transform: rotateY(92deg);
    opacity:0;
  }
  
  /* ===== HOJA ===== */
  .paper{
    position:absolute;
    inset:0;
    border-radius:12px;
    background:
      linear-gradient(transparent 94%, rgba(0,0,0,0.03) 100%),
      #fffdf8;
    box-shadow: 0 15px 40px rgba(0,0,0,0.35);
    border: 1px solid rgba(0,0,0,0.08);
    overflow:hidden;
    transform: translateY(40px);
    opacity:0;
    animation: slideUp 0.75s ease forwards;
  }
  
  @keyframes slideUp{
    to { transform: translateY(0); opacity:1; }
  }
  
  .paper::before{
    content:"";
    position:absolute;
    inset:0;
    pointer-events:none;
    border-radius:12px;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.06);
  }
  
  .paper-top{
    padding: 14px 18px 8px 18px;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    background: rgba(255,255,255,0.5);
  }
  
  .paper-title{
    font-weight: 700;
    color:#222;
    letter-spacing: 0.5px;
  }
  
  .paper-sub{
    font-size: 0.9rem;
    color:#444;
    opacity:0.9;
  }
  
  .paper-content{
    height: calc(85vh - 170px);
    padding: 18px 18px 6px 18px;
    overflow-y:auto;
    color:#222;
    line-height:1.7;
    font-size: 0.97rem;
  }
  
  .paper-controls{
    position:absolute;
    left:0;
    right:0;
    bottom:0;
    padding: 12px 16px 14px 16px;
    background: linear-gradient(to top, rgba(255,253,248,0.98), rgba(255,253,248,0.6), transparent);
  }
  
  .paper-hint{
    font-size: 0.82rem;
    opacity: 0.75;
    text-align:center;
  }
  
  /* Bloques de párrafo renderizados */
  .paragraph{
    margin: 0 0 14px 0;
    white-space: pre-line;
  }
  .paragraph:last-child{ margin-bottom: 10px; }
  
  /* ===== REGALO FINAL ===== */
  .gift-overlay{
    position:fixed;
    inset:0;
    background:
      radial-gradient(circle at center, rgba(255,255,220,0.25), rgba(0,0,0,0.96));
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    z-index:500;
    text-align:center;
    color:#fff;
    padding: 16px;
  }
  
  .gift-light{
    position:absolute;
    width: 340px;
    height: 340px;
    background: radial-gradient(circle, rgba(255,255,200,0.95), transparent 70%);
    animation: glow 2s infinite;
    z-index:1;
    filter: blur(0.2px);
  }
  @keyframes glow{
    0% { transform: scale(0.9); opacity: 0.6; }
    100% { transform: scale(1.18); opacity: 1; }
  }
  
  .gift-box{
    font-size: 6.2rem;
    cursor:pointer;
    z-index:2;
    animation: giftShake 1.2s infinite;
    filter: drop-shadow(0 0 34px rgba(255,215,0,0.9));
  }
  @keyframes giftShake{
    0%,100% { transform: rotate(0deg); }
    25% { transform: rotate(-6deg); }
    75% { transform: rotate(6deg); }
  }
  
  .gift-text{
    margin-top: 18px;
    font-size: 2.1rem;
    font-weight: 800;
    letter-spacing: 0.4px;
    text-shadow:
      0 0 10px rgba(255,255,255,0.9),
      0 0 25px rgba(255,215,0,0.85),
      0 0 45px rgba(255,215,0,0.55);
    z-index:2;
    line-height: 1.2;
  }
  .gift-sub{
    display:block;
    font-size: 1.55rem;
    font-weight: 600;
    opacity: 0.95;
    margin-top: 6px;
  }
  
  .reflection{
    margin-top: 22px;
    width: 100%;
    max-width: 420px;
    z-index:2;
  }
  
  .reflection h4{
    font-size: 1.08rem;
    text-shadow: 0 0 12px rgba(255,255,255,0.65);
  }
  
  .reflection-hint{
    font-size: 0.88rem;
    opacity: 0.92;
  }
  
  .reflection textarea{
    width:100%;
    min-height: 130px;
    border-radius: 14px;
    padding: 12px;
    border:none;
    resize: vertical;
    background: rgba(255,255,255,0.95);
    color:#111;
    font-size: 0.95rem;
    box-shadow:
      0 0 0 2px rgba(255,255,255,0.35),
      0 0 22px rgba(255,215,0,0.25);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    line-height: 1.5;
  }
  
  .fade-out{
    opacity:0;
    transform: translateY(10px);
    pointer-events:none;
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  
  /* ===== Helpers ===== */
  .d-none{ display:none !important; }
  
  /* Mejoras móvil */
  @media (max-width: 380px){
    .paper-content{ font-size: 0.95rem; }
    .gift-text{ font-size: 1.8rem; }
    .gift-sub{ font-size: 1.35rem; }
  }
  